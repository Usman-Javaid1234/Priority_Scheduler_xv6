# xv6 Priority-Based Scheduler

Implementation of a priority-based process scheduler for the xv6 operating system.

**Course**: Operating Systems Fall 2025  
**Institution**: NUST-SEECS  
**Assignment**: Kernel Feature Implementation (Assignment 2)

---

## ðŸ“‹ Overview

This project extends the xv6 operating system kernel with a **priority-based scheduling algorithm**. The original xv6 uses a simple round-robin scheduler that treats all processes equally. Our implementation introduces process priorities, allowing higher-priority processes to receive CPU time preferentially.

### Key Features

- Static priority scheduling (0-31 range, 0 = highest priority)
- New system call: `setpriority(int priority)` 
-  Default priority of 20 for all processes
-  Priority inheritance during `fork()`
-  Input validation and error handling
-  Comprehensive test suite included

---

## Implementation Details

### Modified Kernel Components

| File | Changes Made |
|------|--------------|
| `proc.h` | Added `int priority` field to `struct proc` |
| `proc.c` | Modified `scheduler()` to select highest priority process |
| `proc.c` | Initialized priority in `allocproc()` and `fork()` |
| `proc.c` | Implemented `setpriority()` function |
| `syscall.h` | Added `SYS_setpriority` system call number |
| `syscall.c` | Registered `sys_setpriority` handler |
| `sysproc.c` | Added `sys_setpriority()` wrapper |
| `user.h` | Added user-space function prototype |
| `usys.S` | Added system call stub |
| `defs.h` | Added function declaration |

### Scheduling Algorithm
```c
// Pseudocode for priority scheduler
for each scheduling round:
    acquire ptable lock
    highest_priority_process = NULL
    
    for each process in ptable:
        if process.state == RUNNABLE:
            if highest_priority_process == NULL OR 
               process.priority < highest_priority_process.priority:
                highest_priority_process = process
    
    if highest_priority_process found:
        context_switch_to(highest_priority_process)
    
    release ptable lock
```

**Time Complexity**: O(n) where n = number of processes (NPROC = 64)

### Priority System

- **Range**: 0 (highest) to 31 (lowest)
- **Default**: 20 (medium priority)
- **Validation**: System call rejects priorities outside 0-31 range
- **Inheritance**: Child processes inherit parent's priority at fork time
- **Modification**: Processes can change their own priority via `setpriority()`

---

##  Setup & Installation

### Prerequisites

- Linux environment (Ubuntu 20.04+ recommended)
- QEMU emulator: `sudo apt install qemu-system`
- Build tools: `sudo apt install build-essential git`
- GCC compiler: `sudo apt install gcc g++`

### Clone and Build
```bash
# Clone the repository
git clone https://github.com/Usman-Javaid1234/Priority_Scheduler_xv6.git
cd Priority_Scheduler_xv6

# Build xv6 kernel
make clean
make

# Run xv6 in QEMU (no graphics)
make qemu-nox
```
To run test programs:
./prioritytest
./stresstest
./edgetest
